{"ts":1365110342780,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1365110339641,"patch":[[{"diffs":[[1,"$.ajaxSetup({ cache: false });\r\n\r\nif (typeof console == \"undefined\") {\r\n    window.console = {\r\n\t\t\"log\": function (s) { }\r\n\t}\r\n}\r\n\r\nvar clientErrorLoggingUrl = '/Logging/ClientError'; // url.action 이 안먹어서 직접 경로를 넣어둠....\r\nvar lastClientErrorMessage = \"\"; //  마지막 발생한 Script 에러메시지\r\n\r\nvar ajaxService = {\r\n\t\"Post\": function (url, model, cbSuccess, cbError, options) {\r\n\t\tif (typeof url == \"undefined\")\r\n\t\t\tdebugger;\r\n\r\n\t\tif (typeof model == \"string\") // string 인 경우는 JSON.stringify 된 문자열로 보고 postData 로 싸준다.\r\n\t\t\tmodel = { postData: model }\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: url,\r\n\t\t\tdata: model,\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.Result == ajaxResultEnum.Success) {\r\n\t\t\t\t\tif (cbSuccess) {\r\n\t\t\t\t\t\tcbSuccess(json.Model);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (json.Result == ajaxResultEnum.Error) {\r\n\t\t\t\t\tif (json.ErrorType == \"AuthorizeFailException\") {\r\n\t\t\t\t\t\t$.popup(memberLoginPopupDefaultUrl, 570, 300); // 로그인 팝업 오픈\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (json.ErrorType == \"ClientScriptException\") {\r\n\t\t\t\t\t\t// 이것은 client script 오류를 내보낸 것이므로 무시한다.\r\n\t\t\t\t\t\t//console.log(\"ajaxService ClientScriptException ignore\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (cbError) {\r\n\t\t\t\t\t\tcbError(json.StatusCode, json.ErrorType, json.ErrorMessage);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif ($.hasValue(json.StatusCode) == true\r\n\t\t\t\t\t\t\t\t|| $.hasValue(json.ErrorType) == true\r\n\t\t\t\t\t\t\t\t|| $.hasValue(json.ErrorMessage) == true) {\r\n\t\t\t\t\t\t\tconsole.log(\"code : \" + json.StatusCode\r\n\t\t\t\t\t\t\t\t+ \"\\r\\ntype : \" + json.ErrorType\r\n\t\t\t\t\t\t\t\t+ \"\\r\\nmessage : \" + json.ErrorMessage);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (json.Result == ajaxResultEnum.Redirect) {\r\n\t\t\t\t\tif ($.hasValue(json.Message) == true) {\r\n\t\t\t\t\t\talert(json.Message); // redirect 전에 alert 을 띄운다.\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttop.document.location.href = json.RedirectUrl; // redirect 페이지로 이동\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconsole.log('ajaxSerivce Result Problem ' + JSON.stringify(json));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (xhr, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(\"ajaxService \" + textStatus + \" \" + errorThrown + \"\\r\\n \" + url + \" \" + xhr.responseText);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvar json = JSON.parse(xhr.responseText);\r\n\t\t\t\t\tif (json.Result == ajaxResultEnum.Error) {\r\n\t\t\t\t\t\tif (cbError) {\r\n\t\t\t\t\t\t\tcbError(json.StatusCode, json.ErrorType, json.ErrorMessage, printStackTrace());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// \r\n\t\t\t\t\t\t\tif ($.hasValue(json.StatusCode) == true\r\n\t\t\t\t\t\t\t\t|| $.hasValue(json.ErrorType) == true\r\n\t\t\t\t\t\t\t\t|| $.hasValue(json.ErrorMessage) == true) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"ajaxService error\\r\\ncode : \" + json.StatusCode\r\n\t\t\t\t\t\t\t\t\t+ \"\\r\\ntype : \" + json.ErrorType\r\n\t\t\t\t\t\t\t\t\t+ \"\\r\\nmessage : \" + json.ErrorMessage);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tif (cbError) {\r\n\t\t\t\t\t\tcbError(undefined, undefined, xhr.responseText, printStackTrace());\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tconsole.log(\"ajaxService catch error \" + e);\r\n\t\t\t\t\t\t//\t\t\t\t\t\tvar model = {\r\n\t\t\t\t\t\t//\t\t\t\t\t\t\tMessage: \"ajaxService \" + xhr.responseText + \" \" + url + \" \" + JSON.stringify(model),\r\n\t\t\t\t\t\t//\t\t\t\t\t\t\tUrl: location.href,\r\n\t\t\t\t\t\t//\t\t\t\t\t\t\tLineNo: \"\",\r\n\t\t\t\t\t\t//\t\t\t\t\t\t\tStackTrace: \"\"\r\n\t\t\t\t\t\t//\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//\t\t\t\t\t\tajaxService.Post(clientErrorLoggingUrl, model);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t, \"PostAndRefresh\": function (url, model, message) {\r\n\t\tajaxService.Post(url\r\n\t\t\t, model\r\n\t\t\t, function () {\r\n\t\t\t\tif (message) {\r\n\t\t\t\t\talert(message);\r\n\t\t\t\t}\r\n\t\t\t\tdocument.location.replace(document.location.href);\r\n\t\t\t});\r\n\t}\r\n\t, \"PostAndRedirect\": function (url, model, redirectUrl, message) {\r\n\t\tajaxService.Post(url\r\n\t\t\t, model\r\n\t\t\t, function () {\r\n\t\t\t\tif (message) {\r\n\t\t\t\t\talert(message);\r\n\t\t\t\t}\r\n\t\t\t\tdocument.location.replace(redirectUrl);\r\n\t\t\t});\r\n\t}\r\n\t, \"PostClientScriptError\": function (model) {\r\n\t\t// 로깅을 위해 jquery 의 cache disable timestamp 를 지움\r\n\t\tif (typeof model.Url != \"undefiend\") {\r\n\t\t\tvar idx = model.Url.lastIndexOf(\"_=\");\r\n\t\t\tif (idx > 1) {\r\n\t\t\t\tmodel.Url = model.Url.substring(0, idx - 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar currentClientErrorMessage = JSON.stringify(model);\r\n\t\tif (currentClientErrorMessage != lastClientErrorMessage) {\r\n\t\t\tlastClientErrorMessage = currentClientErrorMessage;\r\n\t\t\tajaxService.Post(clientErrorLoggingUrl, model);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// ignore \r\n\t\t\t// console.log(currentClientErrorMessage);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar ajaxResultEnum = {\r\n\t\"Success\": 0,\r\n\t\"Error\": 1,\r\n\t\"Redirect\" : 2\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":4304}]],"length":4304,"saved":false}
