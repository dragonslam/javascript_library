{"changed":true,"filter":false,"title":"d3.chart.common.js","tooltip":"/d3/d3.chart.common.js","value":"/* d3.chart.common.js - D3 Chart Common Library.\n \twrit by yi seung-yong(dragonslam@nate.com)\n \tdate, 2014/10/04\n*/\nif (typeof com == 'undefined') var com = {};\nif (typeof com.mad == 'undefined') com.mad = {};\nif (typeof com.mad.chart == 'undefined') com.mad.chart = {};\n\n/** ****************************************************************************\n\tChart API \n**/\ncom.mad.chart.handler = function(obj, option) {\n\tif (!d3)\t{\n\t\t$debug(\"Not Found D3 Library.\");\n\t\tthrow new Error(\"D3 Object Exception\");\n\t}\n\tthis.oContaner\t= obj;\n\tthis.oOption\t= (option instanceof Array) ? option[0] : option;\n\tthis.oOptions\t= (option instanceof Array) ? option : null;\n};\ncom.mad.chart.handler.prototype = {\n\tlogging : function(msg) {\n\t\t$debug(\"com.mad.chart : \"+ msg);\n\t},\n\tempty : function() {\n\t\t$(this.oContaner).hide('slow').empty().show();\n\t\treturn this;\n\t},\n\tmessage : function(t) {\n\t\t$(this.oContaner).empty().append(t);\n\t\treturn this;\n\t},\n\tdraw : function(data, addonOption) {\n\t\tvar This = this;\n\t\tvar D3_Center = function(w, h) {\n\t\t\treturn d3.select(This.oContaner).append(\"svg\")\n\t\t\t\t\t.attr(\"width\", (typeof w == 'number') ? w : This.oOption.width)\n\t\t\t\t\t.attr(\"height\", (typeof h == 'number') ? h : This.oOption.height)\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + ((typeof w == 'number') ? w : This.oOption.width) / 2 + \",\" + ((typeof h == 'number') ? h : This.oOption.height) / 2 + \")\");\n\t\t};\n\t\tvar D3_Axis = function() {\n\t\t\treturn d3.select(This.oContaner).append(\"svg\")\n\t\t\t\t\t.attr(\"width\", This.oOption.width)\n\t\t\t\t\t.attr(\"height\", This.oOption.height)\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + This.oOption.margin.left + \",\" + This.oOption.margin.top + \")\");\n\t\t};\n\n\t\tvar drawLineGraph = function(data, addOption) {\n\t\t};\n\n\t\tvar drawMultiLineGraph = function(data, addOption) {\n\t\t\t\n\t\t\tif (typeof This.oOption.format == 'function') {\n\t\t\t\tdata.forEach(function(d) {\n\t\t\t\t\td.date = This.oOption.format(d.date);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tvar margin = This.oOption.margin;\n\t\t\tvar width = This.oOption.width - margin.left - margin.right;\n\t\t\tvar height = This.oOption.height - margin.top - margin.bottom;\n\n\t\t\tvar x = d3.time.scale().range([0, width]);\n\t\t\tvar y = d3.scale.linear().range([height, 0]);\n\t\t\tvar color\t = d3.scale.ordinal().range(This.oOption.colors);\n\t\t\tvar xAxis\t = d3.svg.axis().scale(x).orient(\"bottom\");\n\t\t\tvar yAxis = d3.svg.axis().scale(y).orient(\"left\");\n\t\t\tvar line\t = d3.svg.line()\n\t\t\t\t //.interpolate(\"basis\")\n\t\t\t\t .x(function(d) { return x(d.date); })\n\t\t\t\t .y(function(d) { return y(d.value); });\n\n\t\t\tif (addOption.xAxis) {\t\t\t\t\n\t\t\t\tif (addOption.xAxis.format)\n\t\t\t\t\txAxis.ticks(addOption.xAxis.ticks).tickFormat(d3.time.format(addOption.xAxis.format));\n\t\t\t\telse \n\t\t\t\t\txAxis.ticks(addOption.xAxis.ticks);\n\t\t\t}\n\t\t\tif (addOption.yAxis) {\n\t\t\t\tif (addOption.yAxis.format)\n\t\t\t\t\tyAxis.ticks(addOption.yAxis.ticks).tickFormat(d3.time.format(addOption.yAxis.format));\n\t\t\t\telse \n\t\t\t\t\tyAxis.ticks(addOption.yAxis.ticks);\n\t\t\t}\n\t\t\tcolor.domain(d3.keys(data[0]).filter(function(key) { return key !== \"date\"; }))\n\t\t\tvar lineData = color.domain().map(function(name) {\n\t\t\t\treturn {\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalues: data.map(function(d) {\n\t\t\t\t\t\treturn {date: d.date, value: +d[name]};\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tx.domain(d3.extent(data, function(d) { return d.date; }));\n\t\t\ty.domain([\n\t\t\t\td3.min(lineData, function(c) { return d3.min(c.values, function(v) { return v.value; }); }),\n\t\t\t\td3.max(lineData, function(c) { return d3.max(c.values, function(v) { return v.value; }); })\n\t\t\t]);\n\n\t\t\tvar svg\t = D3_Axis();\n\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"x axis\")\n\t\t\t\t\t.attr(\"transform\", \"translate(0,\" + height + \")\")\n\t\t\t\t\t.call(xAxis);\n\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"y axis\")\n\t\t\t\t\t.call(yAxis);\t\n\n\t\t\tvar graph= svg.selectAll(\".LineGraph\")\n\t\t\t\t.data(lineData)\n\t\t\t\t.enter().append(\"g\")\n\t\t\t\t.attr(\"class\", This.oOption.styleCalss);\n\n\t\t\tgraph.append(\"path\")\n\t\t\t\t.attr(\"class\", This.oOption.styleCalss)\n\t\t\t\t.attr(\"d\", function(d) { return line(d.values); })\n\t\t\t\t.style(\"stroke\", function(d) { return color(d.name); });\n\n\t\t\tif (This.oOption.showLabels) {\t\t\t\n\t\t\t\tgraph.append(\"text\")\n\t\t\t\t\t.datum(function(d) { return {name: d.name, value: d.values[d.values.length - 1]}; })\n\t\t\t\t\t.attr(\"transform\", function(d) { return \"translate(\" + x(d.value.date) + \",\" + y(d.value.value) + \")\"; })\n\t\t\t\t\t.attr(\"x\", 8)\n\t\t\t\t\t.attr(\"dy\", \".35em\")\n\t\t\t\t\t//.attr(\"class\", \"lable\")\n\t\t\t\t\t.attr(\"font-size\", \"12px\")\n\t\t\t\t\t.attr(\"fill\", function(d) { return color(d.name); })\n\t\t\t\t\t.text(function(d) { return d.name; });\n\t\t\t\t\t\n\t\t\t\t\t//\n\t\t\t}\n\t\t\t\n\t\t\tlineData.forEach(function(item) {\t\t\t\t\n\t\t\t\tvar point_type = \"circle\",\n\t\t\t\t\t point_size = 6,\n\t\t\t\t\t point_fill = \"#fff\";\n\t\t\t\tif (addOption && addOption.point) {\n\t\t\t\t\tpoint_type\t= addOption.point.type;\n\t\t\t\t\tpoint_size\t= addOption.point.size;\n\t\t\t\t\tpoint_fill\t\t= addOption.point.fill ? color(item.name) : point_fill;\n\t\t\t\t}\n\t\t\t\tif (point_type == \"circle\") {\t\t\t\t\n\t\t\t\t\tgraph.selectAll(\".point_\"+ item.name)\n\t\t\t\t\t\t.data(item.values)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(point_type)\t\t\t\t\n\t\t\t\t\t\t\t.style(\"fill\", point_fill)\n\t\t\t\t\t\t\t.style(\"stroke\", color(item.name))\n\t\t\t\t\t\t\t.style(\"stroke-width\", \"2px\")\n\t\t\t\t\t\t\t.style('opacity', function(d, i) { return (String(d.value).isEmpty() || d.value == '0') ? 0 : 1 })\n\t\t\t\t\t\t\t.attr(\"class\", \"point\")\n\t\t\t\t\t\t\t.attr(\"r\", point_size)\n\t\t\t\t\t\t\t.attr(\"cx\", function(d, i) { return x(d.date);  })\n\t\t\t\t\t\t\t.attr(\"cy\", function(d, i) { return y(d.value); })\n\t\t\t\t\t\t\t.on(\"mouseover\", function(d) { \n\t\t\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\t\t\td3.select(this).attr('r', point_size + 2);\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tvar tX = x(d.date) - 3, \n\t\t\t\t\t\t\t\t\t\t tY = y(d.value) + 3;\n\t\t\t\t\t\t\t\t\tif (tY < (22 - margin.top)) {\n\t\t\t\t\t\t\t\t\t\ttX = tX + 3;\n\t\t\t\t\t\t\t\t\t\ttY = 20;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n//\t\t\t\t\t\t\t\t\ttooltip(true, tX, tY, color(item.name), String(d.value).money());\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.on(\"mouseout\", function(d){ \n\t\t\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\t\t\td3.select(this).attr('r', point_size);\n//\t\t\t\t\t\t\t\t\ttooltip(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t ;\n\t\t\t\t} \n\t\t\t\t\n\t\t\t\telse {\n\t\t\t\t\tgraph.selectAll(\".point_\"+ item.name)\n\t\t\t\t\t\t.data(item.values)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(point_type)\t\t\t\t\n\t\t\t\t\t\t\t.style(\"fill\", point_fill)\n\t\t\t\t\t\t\t.style(\"stroke\", color(item.name))\n\t\t\t\t\t\t\t.style(\"stroke-width\", \"2px\")\n\t\t\t\t\t\t\t.style('opacity', function(d, i) { return (String(d.value).isEmpty() || d.value == '0') ? 0 : 1 })\n\t\t\t\t\t\t\t.attr(\"class\", \"point\")\n\t\t\t\t\t\t\t.attr(\"width\", point_size)\n\t\t\t\t\t\t\t.attr(\"height\", point_size)\n\t\t\t\t\t\t\t.attr(\"x\", function(d, i) { return x(d.date) - (point_size/2);  })\n\t\t\t\t\t\t\t.attr(\"y\", function(d, i) { return y(d.value) - (point_size/2); })\n\t\t\t\t\t\t\t.on(\"mouseover\", function(d) {\n\t\t\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", point_size + 2).attr(\"height\", point_size + 2)\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) { return x(d.date) - ((point_size+2)/2);  })\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d, i) { return y(d.value) - ((point_size+2)/2); })\n\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\tvar tX = x(d.date), \n\t\t\t\t\t\t\t\t\t\t tY = y(d.value);\n\t\t\t\t\t\t\t\t\tif (tY < (22 - margin.top)) {\n\t\t\t\t\t\t\t\t\t\ttX = tX + 5;\n\t\t\t\t\t\t\t\t\t\ttY = 10;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n//\t\t\t\t\t\t\t\t\ttooltip(true, tX, tY, color(item.name), String(d.value).money());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.on(\"mouseout\", function(d){ \n\t\t\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", point_size).attr(\"height\", point_size)\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) { return x(d.date) - (point_size/2);  })\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d, i) { return y(d.value) - (point_size/2); })\n\t\t\t\t\t\t\t\t\t;\n//\t\t\t\t\t\t\t\t\ttooltip(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t ;\n\t\t\t\t}\n\t\t\t});\n/*\n\t\t\tvar tooltipBox = svg.append(\"rect\").style('opacity', 1).attr('rx', '5').attr('ry', '5');\n\t\t\tvar tooltipText = svg.append('text').style('opacity', 0);\t\t\t\n\t\t\tvar tooltip = function(isView, x, y, fill, text) {\n\t\t\t\tif (isView) {\n\t\t\t\t\ttooltipBox\n\t\t\t\t\t\t.style(\"fill\", \"#fff\")\n\t\t\t\t\t\t.style(\"stroke\", fill).style(\"stroke-width\", 1).style(\"shape-rendering\", \"crispEdges\").style(\"stroke-opacity\", .8)\n\t\t\t\t\t\t.attr(\"x\", x+8).attr(\"y\", y-25).attr(\"width\", \"55\").attr(\"height\", \"20\")\n\t\t\t\t\t\t.transition(100).style(\"opacity\", .7);\n\t\t\t\t\ttooltipText\n\t\t\t\t\t\t.style(\"fill\", fill)\n\t\t\t\t\t\t.attr('x', x+12).attr('y', y-10)\t\t\t\t\t\t\n\t\t\t\t\t\t.transition(200).style('opacity', 1)\n\t\t\t\t\t\t.text(text);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttooltipBox.style(\"opacity\", 0).attr(\"width\", \"0\").attr(\"height\", \"0\");\n\t\t\t\t\ttooltipText.transition(200).text('').style(\"opacity\", 0);\n\t\t\t\t}\n\t\t\t}\n*/\t\t\t\n\t\t\t$('svg .point').tipsy({ \n\t\t\t\tgravity: 's', \n\t\t\t\thtml: true,\n\t\t        fade: true,\n\t\t        opacity: 0.95,\n\t\t\t\ttitle: function() {\n\t\t\t\t\tvar d = this.__data__;\n\t\t\t\t\treturn String(d.value).money(); \n\t\t\t\t}\n\t\t\t});\n\t\t// multi line.\n\t\t};\n\n\t\tvar drawBarGraph = function(data, addOption) {\n\t\t\n\t\t\tif (typeof This.oOption.format == 'function') {\n\t\t\t\tdata.forEach(function(d) {\n\t\t\t\t\td.key = This.oOption.format(d.key);\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar option\t= This.oOption;\n\t\t\tvar margin\t= option.margin;\n\t\t\tvar width\t= option.width - margin.left - margin.right;\n\t\t\tvar height\t= option.height - margin.top - margin.bottom;\n\n\t\t\tvar c\t= d3.scale.ordinal().range(option.colors);\n\t\t\tvar x\t= d3.scale.ordinal().rangeRoundBands([0, width], .1);\n\t\t\tvar y\t= d3.scale.linear().range([height, 0]);\n\t\t\tvar xAxis = d3.svg.axis().scale(x).orient(\"bottom\");\n\t\t\tvar yAxis = d3.svg.axis().scale(y).orient(\"left\");\n\n\t\t\tif (addOption.xAxis) {\t\t\t\t\n\t\t\t\tif (addOption.xAxis.format)\n\t\t\t\t\txAxis.ticks(addOption.xAxis.ticks).tickFormat(d3.time.format(addOption.xAxis.format));\n\t\t\t\telse \n\t\t\t\t\txAxis.ticks(addOption.xAxis.ticks);\n\t\t\t}\n\t\t\tif (addOption.yAxis) {\n\t\t\t\tif (addOption.yAxis.format)\n\t\t\t\t\tyAxis.ticks(addOption.yAxis.ticks, '%').tickFormat(d3.time.format(addOption.yAxis.format));\n\t\t\t\telse \n\t\t\t\t\tyAxis.ticks(addOption.yAxis.ticks, '%');\n\t\t\t}\n\n\t\t\tc.domain(d3.keys(data[0]).filter(function(key) { return key !== \"date\"; }))\n\t\t\tx.domain(data.map(function(d) { return d.key; }));\n\t\t\ty.domain([0, (d3.max(data, function(d) { return d.value; }) < .1 ? .1 : d3.max(data, function(d) { return d.value; }) )]);\n\t\t\tvar blank= x.rangeBand() * .3;\n\t\t\tvar svg = D3_Axis();\n\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"x axis\")\n\t\t\t\t\t.attr(\"transform\", \"translate(0,\" + height + \")\")\n\t\t\t\t\t.call(xAxis);\n\t\t\t\t\n\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"y axis\")\n\t\t\t\t\t.call(yAxis)/*\n\t\t\t\t\t.append(\"text\")\n\t\t\t\t\t\t.attr(\"transform\", \"rotate(-90)\")\n\t\t\t\t\t\t.attr(\"y\", 6)\n\t\t\t\t\t\t.attr(\"dy\", \".71em\")\n\t\t\t\t\t\t.style(\"text-anchor\", \"end\")\n\t\t\t\t\t\t.text(\"Traffic\")\n\t\t\t\t*/\n\t\t\t\t;\n\t\t\t\t\t\t\t\t\n\t\t\t\tsvg.selectAll(\".bar\")\n\t\t\t\t\t.data(data).enter().append(\"rect\")\n\t\t\t\t\t.style(\"fill\", \"#b7b7b7\")\n\t\t\t\t\t.attr(\"x\", function(d) { return x(d.key) + (blank*.5); })\n\t\t\t\t\t.attr(\"y\", 0)\n\t\t\t\t\t.attr(\"width\", x.rangeBand() - blank)\n\t\t\t\t\t.attr(\"height\", height);\n\n\t\t\t\tsvg.selectAll(\".bar\")\n\t\t\t\t\t.data(data).enter().append(\"rect\")\n\t\t\t\t\t.attr(\"class\", \"bar2\")\n\t\t\t\t\t.style(\"fill\", function(d) { return c(d.key); })\n\t\t\t\t\t.attr(\"x\", function(d) { return x(d.key) + (blank*.5); })\n\t\t\t\t\t.attr(\"y\", function(d) { return y(d.value); })\n\t\t\t\t\t.attr(\"width\", x.rangeBand() - blank)\n\t\t\t\t\t.attr(\"height\", function(d) { return height - y(d.value); })\n\t\t\t\t\t.on(\"mouseover\", function(d) {\n\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\td3.select(this).style(\"stroke\", \"#fff\").style(\"stroke-width\", \"5px\").style(\"stroke-opacity\", \".4\");\n\t\t\t\t\t\t\tvar tX = x(d.key)-blank;\n\t\t\t\t\t\t\tvar tY = y(d.value)+5;\n//\t\t\t\t\t\t\ttooltip(true, ((tX > width + margin.right - 110) ? width - 110 : tX), ((tY < (20 - margin.top)) ? 20 : tY), c(d.key), d.text);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on(\"mouseout\", function(d){ \n\t\t\t\t\t\tif (!String(d.value).isEmpty() && d.value != '0') {\n\t\t\t\t\t\t\td3.select(this).style(\"stroke-width\", \"0px\");\n//\t\t\t\t\t\t\ttooltip(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$('svg .bar2').tipsy({ \n\t\t\t\t\tgravity: 's', \n\t\t\t\t\thtml: true,\n\t\t\t        fade: true,\n\t\t\t        opacity: 0.95,\n\t\t\t\t\ttitle: function() {\n\t\t\t\t\t\tvar d = this.__data__;\n\t\t\t\t\t\treturn d.text; \n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tif (option.showLabels) {\n\t\t\t\tsvg.selectAll(\".bar\")\n\t\t\t\t\t.data(data).enter().append(\"text\")\n\t\t\t\t\t.attr(\"x\", function(d) { return x(d.key); })\n\t\t\t\t\t.attr(\"y\", function(d) { \n\t\t\t\t\t\tvar v = y(d.value);\n\t\t\t\t\t\treturn (v < 15) ? 15 : (v > height-10 ? height-10 : v); \n\t\t\t\t\t})\n\t\t\t\t\t.style(\"fill\", \"#000\")\n\t\t\t\t\t.style(\"font-size\", \"12\")\n\t\t\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t\t\t.style(\"text-anchor\", \"left\")\n\t\t\t\t\t.text(function(d) { return (d.value == 0) ? '' : d.text; });\n\t\t\t}\n/*\n\t\t\tvar tooltipBox = svg.append(\"rect\").style('opacity', 1).attr('rx', '3').attr('ry', '3');\n\t\t\tvar tooltipText = svg.append('text').style('opacity', 0);\t\t\t\n\t\t\tvar tooltip = function(isView, x, y, fill, text) {\n\t\t\t\tif (isView) {\n\t\t\t\t\ttooltipBox\n\t\t\t\t\t\t.style(\"fill\", \"#fff\")\n\t\t\t\t\t\t.style(\"stroke\", fill).style(\"stroke-width\", 1).style(\"shape-rendering\", \"crispEdges\").style(\"stroke-opacity\", .8)\n\t\t\t\t\t\t.attr(\"x\", x+8).attr(\"y\", y-25).attr(\"width\", \"110\").attr(\"height\", \"20\")\n\t\t\t\t\t\t.transition(100).style(\"opacity\", .7);\n\t\t\t\t\ttooltipText\n\t\t\t\t\t\t.style(\"fill\", fill)\n\t\t\t\t\t\t.attr('x', x+12).attr('y', y-10)\t\t\t\t\t\t\n\t\t\t\t\t\t.transition(200).style('opacity', 1)\n\t\t\t\t\t\t.text(text);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttooltipBox.style(\"opacity\", 0).attr(\"width\", \"0\").attr(\"height\", \"0\");\n\t\t\t\t\ttooltipText.transition(200).text('').style(\"opacity\", 0);\n\t\t\t\t}\n\t\t\t}\n*/\n\t\t};\n\n\t\tvar drawPieGraph = function(data, addOption) \n\t\t{\n\t\t\tvar radius = Math.min(This.oOption.width, This.oOption.height) / 2;\n\t\t\tvar color = d3.scale.ordinal().range(This.oOption.colors);\n\t\t\tvar arc = d3.svg.arc()\n\t\t\t\t.outerRadius(radius - This.oOption.arcOuter)\n\t\t\t\t.innerRadius(radius - This.oOption.arcInner);\n\n\t\t\tvar pie = d3.layout.pie().sort(null)\n\t\t\t\t.value(function(d) { return d.value; });\n\n\t\t\tvar svg = D3_Center();\n\t\t\tif (typeof This.oOption.background == 'object' \n\t\t\t\t&& This.oOption.background != null && This.oOption.background.length > 0) \n\t\t\t{\n\t\t\t\tdrawImages(svg.selectAll(\"image\").data([0]), This.oOption.background);\n\t\t\t}\n\n\t\t\tvar g = svg.selectAll(\".arc\")\n\t\t\t\t.data(pie(data))\n\t\t\t\t.enter().append(\"g\")\n\t\t\t\t.attr(\"class\", This.oOption.styleCalss);\n\n\t\t\tg.append(\"path\")\n\t\t\t\t.attr(\"d\", arc)\n\t\t\t\t.style(\"fill\", function(d) { return color(d.data.name); });\n\n\t\t\tif (typeof This.oOption.lines == 'object' && This.oOption.lines instanceof Array) {\n\t\t\t\tfor (var i = This.oOption.lines.length-1; i >= 0; i--) {\n\t\t\t\t\tvar s = This.oOption.lines[i];\n\t\t\t\t\tg.append(\"line\")\n\t\t\t\t\t  .attr(\"x1\", s.x1)\n\t\t\t\t\t  .attr(\"x2\", s.x2)\n\t\t\t\t\t  .attr(\"y1\", s.y1)\n\t\t\t\t\t  .attr(\"y2\", s.y2);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof addOption == 'object' && addOption.lines instanceof Array) {\n\t\t\t\tfor (var i = addOption.lines.length-1; i >= 0; i--) {\n\t\t\t\t\tvar s = addOption.lines[i];\n\t\t\t\t\tg.append(\"line\")\n\t\t\t\t\t  .attr(\"x1\", s.x1)\n\t\t\t\t\t  .attr(\"x2\", s.x2)\n\t\t\t\t\t  .attr(\"y1\", s.y1)\n\t\t\t\t\t  .attr(\"y2\", s.y2);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof This.oOption.lables == 'object' && This.oOption.lables instanceof Array) {\n\t\t\t\tfor (var i = This.oOption.lables.length-1; i >= 0; i--) {\n\t\t\t\t\tvar s = This.oOption.lables[i];\n\t\t\t\t\tg.append(\"text\")\n\t\t\t\t\t\t.attr(\"x\", s.x)\n\t\t\t\t\t\t.attr(\"y\", s.y)\n\t\t\t\t\t\t.attr(\"class\", s.styleCalss)\n\t\t\t\t\t\t.style(\"fill\", s.fill)\n\t\t\t\t\t\t.text(\"\"+s.text);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof addOption == 'object' && addOption.lables instanceof Array) {\n\t\t\t\tfor (var i = addOption.lables.length-1; i >= 0; i--) {\n\t\t\t\t\tvar s = addOption.lables[i];\n\t\t\t\t\tg.append(\"text\")\n\t\t\t\t\t\t.attr(\"x\", s.x)\n\t\t\t\t\t\t.attr(\"y\", s.y)\n\t\t\t\t\t\t.attr(\"class\", s.styleCalss)\n\t\t\t\t\t\t.style(\"fill\", s.fill)\n\t\t\t\t\t\t.text(\"\"+s.text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (This.oOption.showLabels) {\n\t\t\t\tg.append(\"text\")\n\t\t\t\t\t.attr(\"transform\", function(d) { return \"translate(\" + arc.centroid(d) + \")\"; })\n\t\t\t\t\t.attr(\"dy\", \".35em\")\n\t\t\t\t\t.style(\"text-anchor\", \"middle\")\n\t\t\t\t\t.text(function(d) { return d.data.name; });\n\t\t\t}\n\t\t};\n\n\t\tvar drawPiePartitionGraph = function(data, addOption) \n\t\t{\n\t\t\tif (This.oOptions.length > 0)\n\t\t\t{\n\t\t\t\tvar svg = D3_Center();\n\n\t\t\t\tfor (var i = This.oOptions.length-1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tvar option = This.oOptions[i];\n\t\t\t\t\tvar radius = Math.min(option.width, option.height) / 2;\n\t\t\t\t\tvar color = d3.scale.ordinal().range(option.colors);\n\t\t\t\t\tvar arc = d3.svg.arc()\n\t\t\t\t\t\t.outerRadius(radius - option.arcOuter)\n\t\t\t\t\t\t.innerRadius(radius - option.arcInner);\n\n\t\t\t\t\tvar pie = d3.layout.pie().sort(null)\n\t\t\t\t\t\t.value(function(d) { return (d.depth == i) ? d.value : null; });\n\n\t\t\t\t\t\n\t\t\t\t\tif (typeof option.background == 'object' && option.background != null && option.background.length > 0) {\n\t\t\t\t\t\tdrawImages(svg.selectAll(\"image\").data([0]), option.background);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar g = svg.selectAll(\".arc ._\"+ i +\"\")\n\t\t\t\t\t\t.data(pie(data))\n\t\t\t\t\t\t.enter().append(\"g\")\n\t\t\t\t\t\t.attr(\"class\", option.styleCalss);\n\n\t\t\t\t\tg.append(\"path\")\n\t\t\t\t\t\t.attr(\"d\", arc)\n\t\t\t\t\t\t.style(\"fill\", function(d) { \n\t\t\t\t\t\t\treturn (d.data.depth == i) ? color(d.data.name) : '#fff'; \n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\tif (option.showLabels) {\n\t\t\t\t\t\tg.append(\"text\")\n\t\t\t\t\t\t\t.attr(\"transform\", function(d) { return \"translate(\" + arc.centroid(d) + \")\"; })\n\t\t\t\t\t\t\t.attr(\"dy\", \".35em\")\n\t\t\t\t\t\t\t.style(\"text-anchor\", \"middle\")\n\t\t\t\t\t\t\t.text(function(d) { return (d.data.value > 0) ? d.data.name : ''; });\n\t\t\t\t\t}\n\t\t\t\t}// for\n\t\t\t}\n\t\t};\n\n\t\tvar drawBandGraph = function(data, addOption) {\n\t\t\tvar option = This.oOption;\n\t\t\tvar width = option.width, height = option.height;\n\t\t\tvar color\t = d3.scale.ordinal().range(option.colors);\n\t\t\tvar x\t= d3.scale.linear().range([0, width])\n\t\t\tvar y\t= d3.scale.ordinal().rangeRoundBands([0, height], .4);\n\t\t\tvar xAxis\t = d3.svg.axis().scale(x).orient(\"top\");\n\n\t\t\tx.domain(d3.extent(data, function(d) { return d.value; })).nice();\n\t\t\ty.domain(data.map(function(d) { return d.name; }));\n\n\t\t\tvar svg = D3_Axis();\n\t\t\tvar g  = svg.selectAll(\".axis\")\n\t\t\t\t.data(data)\n\t\t\t\t.enter()\n\t\t\t\t.append(\"g\").attr(\"class\", \"axis\");\n\t\t\t\t\t\t\n\t\t\tg.append(\"rect\")\n\t\t\t\t.style(\"fill\", \"#b7b7b7\")\n\t\t\t\t.attr(\"x\", 0)\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name)-20; })\n\t\t\t\t.attr(\"width\", width)\n\t\t\t\t.attr(\"height\", y.rangeBand());\n\n\t\t\tg.append(\"rect\")\n\t\t\t\t.style(\"fill\", function(d) { return color(d.name); })\n\t\t\t\t.attr(\"x\", function(d) { return x(Math.min(0, d.value)); })\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name)-20; })\n\t\t\t\t.attr(\"width\", function(d) { return Math.abs(x(d.value) - x(0)); })\n\t\t\t\t.attr(\"height\", y.rangeBand());\n\n\t\t\tg.append(\"text\")\n\t\t\t\t.attr(\"x\", function(d) { return 5; })\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name) + 35; })\n\t\t\t\t.style(\"fill\", \"#335\")\n\t\t\t\t.style(\"font-size\", \"13\")\n\t\t\t\t.style(\"font-weight\", \"900\")\n\t\t\t\t.style(\"text-anchor\", \"left\")\n\t\t\t\t.text(function(d) { return d.text; });\n\n\t\t\tg.append(\"text\")\n\t\t\t\t.attr(\"x\", function(d) { return 10; })\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name) + 5; })\n\t\t\t\t.style(\"fill\", \"#fefefe\")\n\t\t\t\t.style(\"font-size\", \"13\")\n\t\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t\t.style(\"text-anchor\", \"left\")\n\t\t\t\t.text(function(d) { return d.value + d.prepix; });\n\t\t\t\n\t\t\t// g.call(xAxis);\n\t\t\tg.append(\"line\")\n\t\t\t  .attr(\"x1\", x(0))\n\t\t\t  .attr(\"x2\", x(0))\n\t\t\t  .attr(\"y2\", height);\n\n\t\t\tif (option && typeof option.image == 'object' && option.image != null && option.image.length > 0) {\n\t\t\t\tdrawImages(g.selectAll(\"image\").data([0]), option.image);\n\t\t\t}\n\t\t\tif (addOption && typeof addOption.image == 'object' && addOption.image != null && addOption.image.length > 0) {\n\t\t\t\tdrawImages(g.selectAll(\"image\").data([0]), addOption.image);\n\t\t\t}\n\t\t\t\n\t\t};\n\n\t\tvar drawBandGraph2 = function(data, addOption) {\n\t\t\tvar option = This.oOption;\n\t\t\tvar width = option.width, height = option.height;\n\t\t\tvar color\t = d3.scale.ordinal().range(option.colors);\n\t\t\tvar x\t= d3.scale.linear().range([0, width - option.margin.right])\n\t\t\tvar y\t= d3.scale.ordinal().rangeRoundBands([0, height], .4);\n\t\t\tvar xAxis\t = d3.svg.axis().scale(x).orient(\"top\");\n\n\t\t\tx.domain(d3.extent(data, function(d) { return d.value; })).nice();\n\t\t\ty.domain(data.map(function(d) { return d.name; }));\n\n\t\t\tvar svg = D3_Axis();\n\t\t\tvar g  = svg.selectAll(\".axis\")\n\t\t\t\t.data(data)\n\t\t\t\t.enter()\n\t\t\t\t.append(\"g\").attr(\"class\", \"axis\");\n\t\t\t\t\t\t\n\t\t\tg.append(\"rect\")\n\t\t\t\t.style(\"fill\", \"#b7b7b7\")\n\t\t\t\t.attr(\"x\", 0)\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name); })\n\t\t\t\t.attr(\"width\", width-option.margin.right)\n\t\t\t\t.attr(\"height\", y.rangeBand());\n\n\t\t\tg.append(\"rect\")\n\t\t\t\t.style(\"fill\", function(d) { return color(d.name); })\n\t\t\t\t.attr(\"x\", function(d) { return x(Math.min(0, d.value)); })\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name); })\n\t\t\t\t.attr(\"width\", function(d) { return Math.abs(x(d.value) - x(0)); })\n\t\t\t\t.attr(\"height\", y.rangeBand());\n\n\t\t\tg.append(\"text\")\n\t\t\t\t.attr(\"x\", function(d) { return width - option.margin.right + 5; })\n\t\t\t\t.attr(\"y\", function(d) { return y(d.name)+(y.rangeBand()/2)+2; })\n\t\t\t\t.style(\"fill\", \"#666\")\n\t\t\t\t.style(\"font-size\", \"12\")\n\t\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t\t.style(\"text-anchor\", \"left\")\n\t\t\t\t.text(function(d) { return d.text; });\n\n\t\t\tif (option.showLabels) {\n\t\t\t\tg.append(\"text\")\n\t\t\t\t\t.attr(\"x\", function(d) { \n\t\t\t\t\t\tvar v = Math.abs(x(d.value) - x(0));\t\t\t\t\t\t\n\t\t\t\t\t\treturn  (v < 55) ? v + 5 : v - 50;\n\t\t\t\t\t})\n\t\t\t\t\t.attr(\"y\", function(d) { return y(d.name)+(y.rangeBand()/2)+3; })\n\t\t\t\t\t.style(\"fill\", \"#fff\")\n\t\t\t\t\t.style(\"font-size\", \"12\")\n\t\t\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t\t\t.style(\"text-anchor\", \"left\")\n\t\t\t\t\t.text(function(d) { \n\t\t\t\t\t\tvar v = d.value * 100; \n\t\t\t\t\t\treturn (v % 10 == 0 ? v : (v).toFixed(2)) + \"%\"; \n\t\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t// g.call(xAxis);\n\t\t\tg.append(\"line\")\n\t\t\t  .attr(\"x1\", x(0))\n\t\t\t  .attr(\"x2\", x(0))\n\t\t\t  .attr(\"y2\", height);\n\n\t\t\tif (option && typeof option.image == 'object' && option.image != null && option.image.length > 0) {\n\t\t\t\tdrawImages(g.selectAll(\"image\").data([0]), option.image);\n\t\t\t}\n\t\t\tif (addOption && typeof addOption.image == 'object' && addOption.image != null && addOption.image.length > 0) {\n\t\t\t\tdrawImages(g.selectAll(\"image\").data([0]), addOption.image);\n\t\t\t}\n\t\t};\n\t\t\n\t\tvar drawRadarGraph = function(data, addOption) {\n\t\t\tvar w = This.oOption.width,\n\t\t\t\th = This.oOption.height;\n\n\t\t\t//Options for the Radar chart, other than default\n\t\t\tvar mycfg = {\n\t\t\t\tw: w-130,\n\t\t\t\th: h-50,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tlevels: 5,\n\t\t\t\tTranslateX: 45,\n\t\t\t\tTranslateY: 32,\n\t\t\t\tExtraWidthX: 140,\n\t\t\t\tExtraWidthY: 50,\n\t\t\t\tcolor : d3.scale.ordinal().range(This.oOption.colors),\n\t\t\t\tviewLevel : This.oOption.showLabels,\n\t\t\t\tviewLable : This.oOption.showLabels\n\t\t\t};\n\n\t\t\t//Call function to draw the Radar chart\n\t\t\t//Will expect that data is in %'s\n\t\t\tRadarChart.draw(This.oContaner, data, mycfg);\n\n\t\t\tvar svg = d3.select(This.oContaner)\n\t\t\t\t.selectAll('svg')\n\t\t\t\t.append('svg')\n\t\t\t\t.attr(\"width\", w)\n\t\t\t\t.attr(\"height\", h)\n\t\t\t\n\t\t\tif (typeof This.oOption.background == 'object' \n\t\t\t\t&& This.oOption.background != null && This.oOption.background.length > 0) \n\t\t\t{\n\t\t\t\tdrawImages(svg.selectAll(\"image\").data([0]), This.oOption.background);\n\t\t\t}\n\t\t};\n\n\t\tvar drawImages = function(obj, imgs) {\n\t\t\tfor (var i =0; i < imgs.length ; i++)\n\t\t\t{\n\t\t\t\tobj.enter()\n\t\t\t\t\t.append(\"svg:image\")\n\t\t\t\t\t.attr(\"xlink:href\", imgs[i].href)\n\t\t\t\t\t.attr(\"x\", imgs[i].x)\n\t\t\t\t\t.attr(\"y\", imgs[i].y)\n\t\t\t\t\t.attr(\"width\", imgs[i].width)\n\t\t\t\t\t.attr(\"height\", imgs[i].height);\n\t\t\t}\n\t\t};\n\n\n\t\t// Rander Graph...\n\t\t$(This.oContaner).hide().empty();\n\t\tswitch (this.oOption.type) {\n\t\t\tcase 'line' :\n\t\t\t\tdrawLineGraph(data, addonOption);\n\t\t\t\tbreak;\n\n\t\t\tcase 'multiLine' :\n\t\t\t\tdrawMultiLineGraph(data, addonOption);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'bar' :\n\t\t\t\tdrawBarGraph(data, addonOption);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'pie' :\n\t\t\t\tdrawPieGraph(data, addonOption);\n\t\t\t\tbreak;\n\n\t\t\tcase 'piePartition' :\n\t\t\t\tdrawPiePartitionGraph(data, addonOption);\n\t\t\t\tbreak;\n\n\t\t\tcase 'band' :\n\t\t\t\tdrawBandGraph(data, addonOption);\n\t\t\t\tbreak;\n\n\t\t\tcase 'band2' :\n\t\t\t\tdrawBandGraph2(data, addonOption);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'radarChart' : \n\t\t\t\tdrawRadarGraph(data, addonOption);\n\t\t\t\tbreak;\n\t\t}\n\t\t$(This.oContaner).show('fast');\n\n\t}\n};","undoManager":{"mark":12,"position":12,"stack":[[{"start":{"row":0,"column":12},"end":{"row":0,"column":19},"action":"remove","lines":["setting"],"id":3},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["c"]}],[{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["o"],"id":4}],[{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["m"],"id":5}],[{"start":{"row":0,"column":15},"end":{"row":0,"column":16},"action":"insert","lines":["m"],"id":6}],[{"start":{"row":0,"column":16},"end":{"row":0,"column":17},"action":"insert","lines":["o"],"id":7}],[{"start":{"row":0,"column":17},"end":{"row":0,"column":18},"action":"insert","lines":["n"],"id":8}],[{"start":{"row":0,"column":12},"end":{"row":0,"column":18},"action":"remove","lines":["common"],"id":9,"ignore":true},{"start":{"row":0,"column":12},"end":{"row":0,"column":19},"action":"insert","lines":["setting"]}],[{"start":{"row":0,"column":12},"end":{"row":0,"column":19},"action":"remove","lines":["setting"],"id":10},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["c"]}],[{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["o"],"id":11}],[{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["m"],"id":12}],[{"start":{"row":0,"column":15},"end":{"row":0,"column":16},"action":"insert","lines":["m"],"id":13}],[{"start":{"row":0,"column":16},"end":{"row":0,"column":17},"action":"insert","lines":["o"],"id":14}],[{"start":{"row":0,"column":17},"end":{"row":0,"column":18},"action":"insert","lines":["n"],"id":15}],[{"start":{"row":33,"column":5},"end":{"row":33,"column":6},"action":"insert","lines":[" "],"id":22}],[{"start":{"row":33,"column":4},"end":{"row":33,"column":5},"action":"insert","lines":["t"],"id":22}],[{"start":{"row":33,"column":3},"end":{"row":33,"column":4},"action":"insert","lines":["i"],"id":23}],[{"start":{"row":33,"column":2},"end":{"row":33,"column":3},"action":"insert","lines":["g"],"id":24}],[{"start":{"row":32,"column":2},"end":{"row":33,"column":0},"action":"insert","lines":["",""],"id":25},{"start":{"row":33,"column":0},"end":{"row":33,"column":2},"action":"insert","lines":["\t\t"]}],[{"start":{"row":31,"column":2},"end":{"row":32,"column":0},"action":"insert","lines":["",""],"id":26},{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["\t\t"]}],[{"start":{"row":30,"column":14},"end":{"row":31,"column":0},"action":"insert","lines":["",""],"id":27},{"start":{"row":31,"column":0},"end":{"row":31,"column":2},"action":"insert","lines":["\t\t"]}]]},"ace":{"folds":[],"scrolltop":1359,"scrollleft":0,"selection":{"start":{"row":20,"column":35},"end":{"row":20,"column":35},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":96,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1451889147000}